# NoSQL基本知识

### NoSQL

1、概念、代表数据库（键值、文档、宽列、图形类型的存储）

2、一个常见的误解是 NoSQL 数据库或非关系型数据库不能很好地存储关系型数据。NoSQL 数据库可以存储关系型数据—它们与关系型数据库的存储方式不同。

NoSQL 数据库代表：HBase、Cassandra、MongoDB、Redis。

## [SQL 和 NoSQL 有什么区别？](https://javaguide.cn/database/nosql.html#sql-和-nosql-有什么区别)

|              | SQL 数据库                                                   | NoSQL 数据库                                                 |
| :----------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 数据存储模型 | 结构化存储，具有固定行和列的表格                             | 非结构化存储。文档：JSON 文档，键值：键值对，宽列：包含行和动态列的表，图：节点和边 |
| 发展历程     | 开发于 1970 年代，重点是减少数据重复                         | 开发于 2000 年代后期，重点是提升可扩展性，减少大规模数据的存储成本 |
| 例子         | Oracle、MySQL、Microsoft SQL Server、PostgreSQL              | 文档：MongoDB、CouchDB，键值：Redis、DynamoDB，宽列：Cassandra、 HBase，图表：Neo4j、 Amazon Neptune、Giraph |
| ACID 属性    | 提供原子性、一致性、隔离性和持久性 (ACID) 属性               | 通常不支持 ACID 事务，为了可扩展、高性能进行了权衡，少部分支持比如 MongoDB 。不过，MongoDB 对 ACID 事务 的支持和 MySQL 还是有所区别的。 |
| 性能         | 性能通常取决于磁盘子系统。要获得最佳性能，通常需要优化查询、索引和表结构。 | 性能通常由底层硬件集群大小、网络延迟以及调用应用程序来决定。 |
| 扩展         | 垂直（使用性能更强大的服务器进行扩展）、读写分离、分库分表   | 横向（增加服务器的方式横向扩展，通常是基于分片机制）         |
| 用途         | 普通企业级的项目的数据存储                                   | 用途广泛比如图数据库支持分析和遍历连接数据之间的关系、键值数据库可以处理大量数据扩展和极高的状态变化 |
| 查询语法     | 结构化查询语言 (SQL)                                         | 数据访问语法可能因数据库而异                                 |

### 字符集详解

1、MySQL字符集有两套UTF-8编码实现：utf8、utf8mb4；使用utf8，存储一些比较复杂的汉字繁体字和emoji符号容易出错

2、常见的字符集有：ASCII、GB2312、GB18030、GBK、Unicode；区别在于

* 可以表示的字符范围
* 编码方式

3、GB2312（6700） ==》 GBK（20000） ==》GB18030（70000个汉字）；BIG5主要针对繁体中文；

4、为什么会乱码：**编码和解码时用了不同或者不兼容的字符集**

5、Unicode 字符集中包含了世界上几乎所有已知的字符。不过，Unicode 字符集并没有规定如何存储这些字符；后面产生了UTF8（1-4个字节编一个码）、UTF16（2-4）、UTF32（固定4）

* 在UTF-8编码中，普通的汉字通常会占用三个字节的存储空间。UTF-8是一种可变长度的字符编码，用来表示Unicode码点。基本的拉丁字母、数字以及ASCII符号在UTF-8编码下只需要一个字节，而大部分汉字则需要三个字节来表示。
* UTF-8编码下一个汉字(包括中文形式下的符号)一般是3个字节，一个英文(包括英文下的符号)1个字节，一个数字1个字节；
* 在GBK和GB2312编码下一个汉字(包括中文形式下的符号)是2个字节，一个英文(包括英文下的符号)1个字节，一个数字1个字节；
* Unicode编码一个汉字(包括中文形式下的符号)和一个英文(包括英文下的符号)一个数字都是4个字节；
* ASCII编码一个英文(包括英文下的符号)1个字节(不支持中文汉字)，一个数字1个字节；
* ISO 8859-1编码一个英文(包括英文下的符号)1个字节(不支持中文汉字)，一个数字1个字节

### MySQL默认

1、5.7默认latin1；8.0中默认utf8mb4；

2、MySQL 中的字符集有以下的层次级别：

- `server`（MySQL 实例级别）
- `database`（库级别）
- `table`（表级别）
- `column`（字段级别）

它们的优先级可以简单的认为是从上往下依次增大，也即 `column` 的优先级会大于 `table` 等其余层次的。如指定 MySQL 实例级别字符集是`utf8mb4`，指定某个表字符集是`latin1`，那么这个表的所有字段如果不指定的话，编码就是latin1

3、如果在执行具体语句时未指定字符集，那么 MySQL 将会使用上一级 级别的字符集