## 登录

1、检验账号：web端账号密码、小程序是手机验证码

前后端分离的项目，数据以JSON 的方式进行请求和响应，当收到请求的时候，会校验账号和密码以及验证码参数；

* 首先前端检验参数是否合法（手机号码是否11位，密码格式），是否非空；失败就直接返回失败信息，重新回到登陆页面
* 手机验证码可以限制次数，比如一分钟一次，使用set ex或者set nx过期时间，检验验证码是否正确，在redist里面存的验证码和用户比对，
* 参数没问题的话，检查账号密码是否频繁登录，需要借助redis的zset数据结构，设计一个时间窗口限流算法实现（登录，点赞，评论等），进行限流，避免对数据库造成压力
* 如果没有限流，就查询用户数据，检查是否存在，并进行密码校验，这里检验密码的时候，使用了一个随机盐的一个工具类BCrypt实现，安全度较高

2、前后端测试： Postman  可以创建团队，把接口写好了之后放在团队里面

3、调用ES进行搜索，为什么不用mysql，主要是模糊查询，容易不走索引，查询效率很低，需要随机IO，性能比较低；ES可以进行分词索引，只需将信息放进ES服务器中，查询时可以返回需要的内容

4、ThreadLocal:保存用户线程信息，后续的controller，sevice 就可以随时随地获取用户信息

5、部署项目：

６、SQL查询并优化

７、实现方式很简单，我们提前购买了IP 地址数据的省级离线库 ® https://user.ip138.com/ip/lib/我们是在发布的时候，从请求头中获取到客户端IP 地址信息，然后查询数据库中的数据，得到发布的地点，随着文章或评论一起保存到数据库表中就可以了。

